= API management integrert med nasjonale felleskomponenter
:wysiwig_editing: 1
ifeval::[{wysiwig_editing} == 1]
:imagepath: ../images/
endif::[]
ifeval::[{wysiwig_editing} == 0]
:imagepath: main@unit-ra:unit-ra-datadeling-målarkitekturen:
endif::[]
:toc: left
:toclevels: 4
:sectnums:
:sectnumlevels: 9

​​Det er behov for datadeling og API Management på tvers av sektorer. Høyere utdanning og forskning ønsker utstrakt bruk av nasjonale felleskomponenter, som omtalt i Digitaliseringsrundskrivet. For å oppnå dette må infrastrukturen videreutvikles.​ 

Føderert tilgangsstyring for datadeling på tvers av sektorer krever blant annet standardisering av tilgangstokens for å oppnå gjennomgående tillitskjeder. ​Figuren viser kobling til maskinporten fra sektoren vår da det er fullt mulig å benytte maskinporten direkte uten føderering av tilgangsstyring. Det er også ønskelig at brukere kan gi samtykke til sine data et sted nasjonalt, inklusivt til kilder i høyere utdanning og forskning. Samtykke til kilder i vår sektor fra Altinn autorisasjon er foreløpig ikke imlementert, så ingen kobling til Altinn autorisasjon er visst i figuren. ​

.API management integrert med nasjonale felleskomponenter
image::{imagepath}API management integrert med nasjonale felleskomponenter.png[alt=API management integrert med nasjonale felleskomponenter image]



[cols ="1,3", options="header"]
.Elementer i view for API management integrert med nasjonale felleskomponenter
|===

| Element
| Beskrivelse

| UHF Infrastruktur <grouping>
| Felleskomponenter i UHF-infrastrukturen for datadeling

| Tokentjeneste <application-service>
| Tjeneste som utsteder sikkerhetsbilletter. Sikkerhetsbillett utstedes basert på tildelte rettigheter og eventuelle representasjonsforhold.

| Registrere API i UHF sektoren <application-service>
| Programtjeneste for å registrere og vedlikeholde API som er tilgjengelige i Universitets og Høyskole-sektoren

| UHF tildel rettigheter til klienter <application-service>
| Tildel autoriserte rettigheter basert på roller 

| Ressursportal <application-component>
| Test

| UHF Oauth2 autorisasjonstjener <application-component>
| Autorisasjonstjenester realiserer tilgangskontroll gjennom å utstede OpenID Connect eller OAuth 2 grants og tokens. 
En autorisasjonstjener er også brukt til å realisere tilgangs policy. 

Scope (rettighet) og Audience (identifikator eller ressurs-server f. eks. FS)

////
Per i dag er Scopes er grovkornet
Rich authorization requsts (ny spesifikasjon) for å utvide scope begrep i IETF
underenhet og behandlingssted, behandlingsgrunnlag og roller jobbes det med.
////

| UHF Klientregister <application-component>
| Oversikt over alle klienter som er blitt tildelt tilgang til ressurser.


| UHF API manager  <application-component>
| Administrativ komponent som kontrollerer policy og livssyklus for definisjon og forvaltning av API. 
Tilganger gjennom et API defineres i API manager og tildeles av autorisasjonstjener. 

Ansvaret til API manager inkluderer:
  * Sentralisert API Gateway som håndterer sikkerhetsretningslinjer, og sender kall til bakenforliggende API 
  * Sentralisert publisering av API spesifikasjon (OpenAPI/RAML), dokumentasjon
  * Sentralisert API administrasjon og forvaltning av API-katalogen
  * Håndtering av registrerings- og introduksjonsprosesser for API utviklere
  * Håndtere livssyklusen til et API, uvikling, test, utrulling, nye versjoner, nedlegging
  * Ivareta registrering, forvaltning og og utvikling av klientrettigheter
  * Rapportering og analyse for å monitorere bruk og last 



| UHF API katalog <application-component>
| Oversikt over alle API som er registrert 

UHF API katalog kan inneholde
  * Navn på API
  * Tekstlig beskrivelse av API
  * Informasjonsmodell / Datamodell for API som tilbys 
  * Kildeinformasjon for data, begrepsinformasjon
  * Informasjon om tilgang, juridiske og tekniske begrensinger for bruk
  * Eksempelkode, interaktiv API-konsoll og sandkasse for test
  * Informasjon om hvordan få support og hjelp fra utsteder

| Nasjonal infrastruktur <grouping>
| 

| Maskinporten <application-component>
| [Torget]
Maskinporten er en løsning for tilgangsstyring for virksomheter som utveksler data. Løsningen garanterer identiteten mellom virksomheter, og sørger for maskin-til-maskin autentisering.

[Verktøykasse for deling av data]
Maskinporten sørger for sikker autentisering og tilgangskontroll for datautveksling mellom
virksomheter, maskin til maskin. Dette gir teknisk og organisatorisk samhandlingsevne.

Mer om Maskinporten:
https://www.digdir.no/digitale-felleslosninger/maskinporten/869

| Altinn autorisasjon <application-component>
| [Torget]
Autorisasjonskomponenten i Altinn som gir muligheter til å delegere rettigheter til andre organisasjoner eller personer. Rettigheter til bruk av autorisasjonskomponenten baserer seg på registrerte roller i Enhetsregisteret.
Altinn autorisasjon leverer også tjenester for å registrere og kontrollere samtykke gitt av person eller virksomhet.

[Verktøykasse for deling av data]
Altinn autorisasjon gir teknisk samhandlingsevne ved at bruker logger inn med elektronisk ID,
autorisasjonskomponenten sjekker at bruker har de tilgangene som kreves for å ta i bruk aktuell tjeneste.

Dersom en privatperson skal ta i bruk en tjeneste på vegne av en virksomhet, gjøres det et oppslag mot Enhetsregisteret for å bekrefte at personen har en rolle på vegne av virksomheten. Dette gir organisatorisk samhandlingsevne.

Mer om Altinn autorisasjon:
https://www.altinndigital.no/produkter/styring-av-tilgang/


| Felles API-katalog <application-component>
| Del av Felles datakatalog som gir mulighet for å søke etter API-er og lese API-spesifikasjoner https://fellesdatakatalog.brreg.no/apis

|===

